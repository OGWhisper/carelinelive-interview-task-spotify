<section class="search">
    <input
        placeholder="Search for a playlist"
        (ngModelChange)="searchValue$.next($event.toString())"
        ngModel=""
    />
    <section *ngIf="((search$ | async) || []).length == 0">No Results</section>
    <section *ngIf="search$ | async as search">
        <app-search-playlist-element
            (emitter)="playlistID$.next($event.toString())"
            [data]="result"
            *ngFor="let result of search$ | async"
        >
        </app-search-playlist-element>
    </section>
</section>
<!-- Todo: Spinner -->
<main class="playlist" *ngIf="playlist$ | async as playlist">
    <header class="playlist-header">
        <img [src]="playlist.images[0].url" alt="" />

        <div class="playlist-details">
            <h1>{{ playlist.name }}</h1>
            <p>{{ playlist.description }}</p>
            <p>{{ playlist.owner.name }}</p>
        </div>
    </header>

    <section class="playlist-analytics">
        <h2>Playlist Analytics</h2>

        <app-playlist-analysis [playlist]="playlist"> </app-playlist-analysis>
    </section>

    <section class="playlist-tracks">
        <header>
            <h2>Tracks</h2>
            <p>{{ playlist.tracks.total }} tracks</p>
        </header>
        <table>
            <thead>
                <tr>
                    <th class="track-index">#</th>
                    <th>Track Name</th>
                    <th>Album</th>
                    <th class="track-duration">Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let track of playlist.tracks.items; let i = index">
                    <td class="track-index">{{i + 1}}</td>
                    <td class="track-details">
                        <div class="flex-wrapper">
                            <img
                                class="track-image"
                                [src]="track.album.image?.url"
                            />
                            <aside class="track-overview">
                                <b class="track-name">
                                    {{ track.name }}
                                </b>
                                <p class="track-artist">
                                    <span
                                        *ngFor="
                                            let artist of track.artists;
                                            let i = index
                                        "
                                    >
                                        {{ artist }}
                                        <span class="comma"
                                            *ngIf="i < track.artists.length - 1"
                                            >,</span
                                        >
                                    </span>
                                </p>
                            </aside>
                        </div>
                    </td>
                    <td>
                        {{track.album?.name}}
                    </td>
                    <td class="track-duration">
                        {{ track.duration_ms | date:'mm:ss'}}
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</main>
